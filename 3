네 모의해킹 리뷰 진행하겠습니다.

롯데 연간 상시 취약점 진단 결과로
진단 대상은 총 4개의 시스템에 대해 진단하였습니다.
몇건의 ~ 13건 취약점 이 발생했습니다.

아래 취약점 상세결과를 살펴보겠습니다.
첫번째 시스템은 상사 홈페이지이며 정보누출 취약점입니다.
상사 홈페이지에서 정보누출 취약점이 4건이 발생했으며
정보누출 취약점은 직접적인 공격을 통해 취약점들이 발생하는것이 아닌
노출되는 취약점으로 인해 2차 공격에 정보수집에 활용 될 수 있는 건들입니다.

살펴보면 405 응답 코드 내 에러 메세지 내 서버 종류 버전들이 노출됩니다.
해당 서버 버전의 알려진 취약점 공격이 이루어질 수 있는 정보수집에 활용됩니다.
따라서 해당 취약점은 에러 발생 시 설정한 커스텀 페이지 내 리다이렉트되게 설정되어야합니다.

다음으론 헤더 내 서버 버전 노출입니다.
해당 취약점도 동일하게 버전이 노출되나 노출되는 지점이 헤더 값 입니다.
 서버 버전에 알려진 취약점 공격의 정보수집에 활용되며
해당 웹 설정 파일을 통해 해당 헤더를 삭제처리하여야합니다.

다음으로 계정 로그인 실패 시 상이한 응답 취약점입니다.
존재하는 계정과 존재하지 않는 계정에 대한 상이한 응답을 통해
존재하는 계정 여부를 파악 후 브루트 포스 등과 같은 취약점에 활용되어 계정 탈취로 이루어질 수 있습니다.
따라해서 해당 취약점은 존재하는 계정과 존재하지 않는 계정의 로그인 실패 시 동일한 실패 문구로 이루어져야합니다.

다음으론 절대 경로 노출 취약점입니다.
이미지 파일의 이름 값을 임의로 변경하여 400대 에러를 유발합니다.
400 코드 내 이미지가 저장되는 웹 서버의 실제 경로들이 노출됩니다.
노출된 경로 및 디렉터리 환경 등을 파악하여 다른 취약점과 연계하여 서버 내 중요 정보들을 탈취할 수 있습니다.
따라서 400 에러 발생 시 설정한 커스텀 페이지 내 리다이렉트되게 설정하여 취약 정보들이 노출되지 않도록 설정해야합니다.


다음은 불충분한 인증 취약점입니다.
로그인 페이지에서 계정 및 임의의 비밀번호 1을 입력하여 로그인을 시도 합니다.
패킷이 서버에서 클라이언트로 전송 전 중간 지점에서 패킷을 잡아 리다이렉트 되는 location 값을 임의로 변조합니다.
원래 로그인 실패 시 login 페이지로 리다이렉트되게 설정되어 있지만 강제로 index 페이지로 리다이렉트되게 변조 시
공격자가 admin 페이지 내 존재하는 메뉴 들에 대해 접근이 가능하며 쓰기 삭제 공격 구문 삽입 등의 공격에 이루질 수 있습니다.
현재 취약점에 대해서 문제점이 검증 로직이 서버단이 아닌 클라이언트 단에 존재하는 것이므로
로그인의 검증 로직은 서버단에서 구현되어야 합니다.

다음으론 크로스사이트 스크립팅입니다.
어드민 페이지 해당 게시판 메뉴에 접근하여 게시글 작성 후 업로드를 진행합니다
요청 패킷 내 악성 스크립트를 삽입 하여 전송합니다.
악성 스크립트 삽입 후 사용자 게시판에 접근 시 삽입한 악성 스크립트가
발생하는것을 확인하였습니다. 해당 취약점을 통해 보고서 내용 처럼
피싱 사이트로 접근을 유도하는 스크립트를 삽입하여 세션탈취,악성파일 배포 금전적 피해 등이 이루어질수있습니다.
따라서 특수문자 이벤트핸들러 태그 등과 같은 입력값을 서버단에서 필터링하는 로직을 구현해야합니다.

상사 측에서의 발생한 취약점의 존재하는 로그인 실패 팝업창을 통해 계정 유무를 파악하여
어드민 계정 획득 후 로그인 실패 로직을 우회 후 게시판에 접근하여 악성 스크립트를 삽입하여 피해를 끼치는
연계되는 시나리오가 발생됩니다.

다음 시스템은 쌀명당입니다. 쌀명당 일반 사이트와,관리자 페이지 보안장비 탐지 규칙으로 인해
패턴적인 입력값 삽입 시 ip가 block됩니다. 따라서 해당 시스템들은 입력 값 검증에는 다소 어려움이 있었으며
UI단에서 노출되는 정보들 위주로 찾는 방향으로 진행하였습니다.

첫번째 취약점은 프로세스 검증 누락입니다.
마이페이지 2차 인증 부재이며 마이페이지 내 회원정보 수정 메뉴에 접근 합니다.
보통 회원 정보 수정등과 같은 중요 메뉴에 접근 시 2차 확인 절차가 필요한데
해당 검증 절차가 누락되었습니다. 그결과로 공격자가 회원의 개인정보 탈취가 가능하며
임의로 회원탈퇴까지 가능합니다.
현재 쌀명당 사이트에서 구글연동 네이버 연동등과 같은 방법으로 회원 가입을 진행하는데,
이럴 경우 회원정보수정 메뉴에 접근 시 OTP 인증 절차를 통해서 접근하도록 설정되어야합니다.

쌀명당 관리자페이지는 금번 진단 시 발견된 취약점이 없습니다.


마지막 시스템 전자 결재입니다.

정보누출 취약점은 위에 설명드린 상사 홈페이지 건들과 동일한 취약점들입니다.
에러 코드 메세지 내 서버 종류 버전 노출되어 해당 취약점도 
에러 발생 시 설정한 커스텀 페이지 내 리다이렉트되게 설정되어야합니다.

다음으론 헤더 내 서버 버전 노출입니다.
헤더 내 서버 종류 및 버전이 노출되며 웹 설 정 파일을 통해 해당 헤더를 삭제하여야합니다.

다음으로 절대 경로 노출 취약점이며
에러 코드 발생시 메세지 내 웹 서버의 실제 경로들이 노출됩니다.
해당 취약점도 설정한 커스텀 페이지로 리다이렉트되게끔 구현되어야합니다.

다음으론 파일 업로드
해당 메뉴 게시판 내 접근하여 임의의 게시글을 작성합니다.
jpg형식의 파일을 업로드 후 저장을 시도 합니다.
저장 시도 시 요청 값 내 jpg 확장자를 asp로 변조 하여 전송합니다.
변조 후 전송 시 악성 파일이 업로드 및 다운로드가 가능합니다.
해당 취약점은 실행권한이 부여되지 않아 웹쉘이 실행되진 않으나
악성 확장자가 다운로드가 가능하여 공격자들은 해당 방식을 노려
악성 코드를 담은 파일을 업로드 한 뒤 다운받은 공격자가 해당 악성파일을 실행 시
로컬 pc의 감염 등의 피해가 발생할 수 있습니다.
따라서 화이트리스트 기반의 파일명·확장자 검증 로직을 서버측에서 구현해야합니다.

 다음으론 파일 다운로드
해당 메뉴 내 접근하여 임의의 파일을 선택하여 다운로드를 진행합니다.
기존에 다운로드를 진행하려던 파일명을 삭제한 뒤 서버 환경 설정 파일명과
상위 디렉터리로 경로를 이동하는 구문을 삽입하여 전송합니다.
전송 시 응답 값 내 webconfig 파일 내부가 노출되는 것을 확인할 수 있습니다.
조치방안으로는 서버 측에서 입력갑 검증을하여 취약점에 활용되는../와 ../의 우회기법들 필터링 및
다운로드 대상 파일을 DB 매핑값으로 식별하여 실제 경로를 직접 참조하지 않도록 처리해야합니다.

다음으론 데이터 평문 전송
https 암호화 통신이 미적용되어 있습니다.
ssl이 미적용될 경우 패킷 송수신 시 시스템 내 중요정보들이 평문으로 전송됩니다.
따라서 ssl을 적용하여 tls 1.2이상 버전을 적용하여야합니다.

총 13건의 취약점 리뷰는 진행되었으며 해당 취약점에 대한 상세한 조치방법으론
아래 조치가이드를 확인하셔서 조치하실때 참고하시면 됩니다.

질문사항있으시면 말씀해주세요

네 이상으로 리뷰 마치겠습니다 고생하셨습니다.
